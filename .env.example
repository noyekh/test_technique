# .env.example - Configuration Legal RAG PoC v1.10
# Copier vers .env et remplir les valeurs

# =============================================================================
# API KEYS (REQUIS)
# =============================================================================

# OpenAI - https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-key-here

# Voyage AI - https://dash.voyageai.com/ (200M tokens gratuits)
VOYAGE_API_KEY=pa-your-voyage-key-here

# =============================================================================
# MODELS (optionnel - valeurs par défaut recommandées)
# =============================================================================

# LLM pour génération de réponses
OPENAI_CHAT_MODEL=gpt-4.1-mini

# Embeddings Voyage AI
VOYAGE_EMBED_MODEL=voyage-3-large
VOYAGE_EMBED_DIMENSIONS=1024

# =============================================================================
# RAG RETRIEVAL (optionnel)
# =============================================================================

RAG_COLLECTION=legal_docs

# v1.9.1: Cosine thresholds DISABLED (anti-pattern per Cambridge 2025)
# Filtering now via RERANK_MIN_SCORE, not cosine similarity
RAG_MIN_RELEVANCE=0.0
RAG_KEEP_RATIO=0.8
RAG_KEEP_FLOOR=0.15
RAG_TOP_K=6

# Initial retrieval pool for reranker (wider = better recall)
RETRIEVAL_TOP_K=100

# Hybrid BM25+Dense search
HYBRID_SEARCH=true
BM25_WEIGHT=0.6

# =============================================================================
# CHUNKING (optionnel)
# =============================================================================

# Token-aware chunking with French legal separators
CHUNK_SIZE_TOKENS=768
CHUNK_OVERLAP_TOKENS=115

# =============================================================================
# PIPELINE RAG v1.9+ (optionnel)
# =============================================================================

# Reranking Voyage rerank-2.5 (+40% MRR)
RERANK_ENABLED=true
RERANK_MODEL=rerank-2.5
RERANK_TOP_N=15
RERANK_MIN_SCORE=0.3

# Multi-query expansion (+25% recall)
MULTI_QUERY_ENABLED=true
MULTI_QUERY_VARIANTS=3
MULTI_QUERY_K_PER_QUERY=50

# Citation verification post-LLM (-90% fausses citations)
CITATION_VERIFICATION_ENABLED=true
CITATION_VERIFICATION_LEVEL=presence
CITATION_SEMANTIC_THRESHOLD=0.6
CITATION_MIN_OVERLAP_WORDS=3

# =============================================================================
# SECURITY & LIMITS (optionnel)
# =============================================================================

# Streaming DISABLED by default for legal contexts
ENABLE_STREAMING=false

# Anti-exfiltration
MAX_ANSWER_CHARS=4000
MAX_QUESTION_LEN=2000

# Upload limits
MAX_FILE_SIZE_MB=10

# Rate limiting (per session)
RATE_LIMIT_MAX_REQUESTS=20
RATE_LIMIT_WINDOW_SECONDS=60

# =============================================================================
# AUTHENTICATION (optionnel)
# =============================================================================

# Activer/désactiver l'authentification (défaut: true)
AUTH_ENABLED=true
